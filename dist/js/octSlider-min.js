"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var o,l=t[Symbol.iterator]();!(i=(o=l.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),template={content:'<div class="octs-outter" aria-live="polite" >\n\t\t\t\t\t<ul class="octs-item-list" ></ul>\n\t\t\t\t\t<ul class="octs-navigator-list" ></ul>\n\t\t\t\t\t<div class="octs-button-group" >\n\t\t\t\t\t\t<button class="octs-button octs-button-prev" role="button" ></button>\n\t\t\t\t\t\t<button class="octs-button octs-button-next" role="button" ></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',item:'<li class="octs-item" >\n\t\t\t\t<section class="octs-item-main" >\n\t\t\t\t\t<img src="" alt="" />\n\t\t\t\t</section>\n\t\t\t\t<footer class="octs-item-footer" >\n\t\t\t\t\t<a href="#"></a>\n\t\t\t\t</footer>\n\t\t\t</li>',navigator:'<li class="octs-navigator-item" role="button" ></li>'},parseDom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},genItemDom=function(t){var e=parseDom(template.item)[0],n=e.children[0].children[0],i=e.children[1].children[0];return n.src=t.img,n.alt=t.title,i.href=t.link,i.innerText=t.title,e},genNavigatorDom=function(t){var e=parseDom(template.navigator)[0];return e},insertItemDom=function(t,e){var n=t.children[0],i=!0,r=!1,a=void 0;try{for(var o,l=e.entries()[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var s=_slicedToArray(o.value,2),c=(s[0],s[1]),d=genItemDom(c);n.appendChild(d)}}catch(t){r=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return t},insertNavigatorDom=function(t,e){var n=t.children[1],i=!0,r=!1,a=void 0;try{for(var o,l=e.entries()[Symbol.iterator]();!(i=(o=l.next()).done);i=!0){var s=_slicedToArray(o.value,2),c=s[0],d=s[1],u=genNavigatorDom(d);0===c&&u.classList.add("octs-navigator-item-active"),n.appendChild(u)}}catch(t){r=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(r)throw a}}return t},removeNavigatorStatus=function(t){var e=t.children[1].children,n=!0,i=!1,r=void 0;try{for(var a,o=[].entries.call(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var l=_slicedToArray(a.value,2),s=(l[0],l[1]);s.classList.remove("octs-navigator-item-active")}}catch(t){i=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(i)throw r}}},slidePrev=function(t,e,n){return new Promise(function(i,r){for(var a=t.children[0],o=t.children[1],l=o.children[e],s=a.style.transition,c=getIndex(o,null,function(t){return t.classList.contains("octs-navigator-item-active")}),d=n?1:c-e,u=[].map.call(a.children,function(t){return t}),v=u.length-1,f=u[0],m=0;m<d;m++){var h=u[v-m];a.insertBefore(h,f),f=h}a.style.cssText="transition: none;\n\t\t\t\t\t\t\tmargin-left: -"+d+"00%;",setTimeout(function(){a.style.cssText="transition: "+s+";\n\t\t\t\t\t\t\t\tmargin-left: 0%;";var e=function e(){removeNavigatorStatus(t),l.classList.add("octs-navigator-item-active"),a.removeEventListener("transitionend",e,!1),t.canSlide=!0,i()};a.addEventListener("transitionend",e,!1)},0),t.canSlide=!1})},slideNext=function(t,e,n){return new Promise(function(i,r){var a=t.children[0],o=t.children[1],l=o.children[e],s=a.style.transition,c=getIndex(o,null,function(t){return t.classList.contains("octs-navigator-item-active")}),d=n?1:e-c,u=[].map.call(a.children,function(t){return t});a.style.marginLeft="-"+d+"00%";var v=function e(){for(var n=0;n<d;n++)a.appendChild(u[n]);a.style.cssText="transition: none;\n\t\t\t\t\t\t\t\tmargin-left: 0%;",setTimeout(function(){a.style.transition=s,removeNavigatorStatus(t),l.classList.add("octs-navigator-item-active"),a.removeEventListener("transitionend",e,!1),t.canSlide=!0,i()},0)};a.addEventListener("transitionend",v,!1),t.canSlide=!1})},getIndex=function(t,e,n){var i=t.children,r=!0,a=!1,o=void 0;try{for(var l,s=[].entries.call(i)[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var c=_slicedToArray(l.value,2),d=c[0],u=c[1];if(e===u)return d;if(n&&n(u))return d}}catch(t){a=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(a)throw o}}},addEventListener=function(t,e){var n=t.children[0].children.length,i=t.children[2].children[0],r=t.children[2].children[1],a=t.children[1],o=!1;t.index=0,t.slide=Promise.resolve(),t.canSlide=!0;var l=function(e){t.canSlide&&(t.slide=t.slide.then(function(){return t.index=t.index-1<0?n-1:t.index-1,t.index===n-1?slidePrev(t,t.index,!0):slidePrev(t,t.index,!1)}))},s=function(e){t.canSlide&&(t.slide=t.slide.then(function(){return t.index=(t.index+1)%n,0===t.index?slideNext(t,t.index,!0):slideNext(t,t.index,!1)}))};if(i.addEventListener("click",l,!1),r.addEventListener("click",s,!1),a.addEventListener("click",function(e){var n=e.target;t.canSlide&&"li"===n.tagName.toLowerCase()&&(t.slide=t.slide.then(function(){var e=getIndex(a,n);return e>t.index?(t.index=e,slideNext(t,t.index,!1)):e<t.index?(t.index=e,slidePrev(t,t.index,!1)):void 0}))},!1),t.addEventListener("mouseover",function(t){o=!0},!1),t.addEventListener("mouseout",function(t){o=!1},!1),e.autoRun){var c=function t(){o||(e.reverse?l():s()),setTimeout(t,e.time)};setTimeout(c,e.time)}return t},defaultSetting={autoRun:!1,reverse:!1,time:3e3},octSlider=function(t,e,n){n=Object.assign(defaultSetting,n);var i=parseDom(template.content)[0];i=insertItemDom(i,e),i=insertNavigatorDom(i,e),i=addEventListener(i,n),t.appendChild(i)};exports.default=octSlider;