"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),template={content:'<div class="octs-outter" aria-live="polite" >\n\t\t\t\t\t<ul class="octs-item-list" ></ul>\n\t\t\t\t\t<ul class="octs-navigator-list" ></ul>\n\t\t\t\t\t<div class="octs-button-group" >\n\t\t\t\t\t\t<button class="octs-button octs-button-prev" role="button" ></button>\n\t\t\t\t\t\t<button class="octs-button octs-button-next" role="button" ></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',item:'<li class="octs-item" >\n\t\t\t\t<section class="octs-item-main" >\n\t\t\t\t\t<img src="" alt="" />\n\t\t\t\t</section>\n\t\t\t\t<footer class="octs-item-footer" >\n\t\t\t\t\t<a href="#"></a>\n\t\t\t\t</footer>\n\t\t\t</li>',navigator:'<li class="octs-navigator-item" role="button" ></li>'},parseDom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},genItemDom=function(t){var e=parseDom(template.item)[0],n=e.children[0].children[0],r=e.children[1].children[0];return n.src=t.img,n.alt=t.title,r.href=t.link,r.innerText=t.title,e},genNavigatorDom=function(t){var e=parseDom(template.navigator)[0];return e},insertItemDom=function(t,e){var n=t.children[0],r=!0,i=!1,o=void 0;try{for(var a,l=e.entries()[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=_slicedToArray(a.value,2),c=(s[0],s[1]),d=genItemDom(c);n.appendChild(d)}}catch(t){i=!0,o=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}return t},insertNavigatorDom=function(t,e){var n=t.children[1],r=!0,i=!1,o=void 0;try{for(var a,l=e.entries()[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=_slicedToArray(a.value,2),c=s[0],d=s[1],u=genNavigatorDom(d);0===c&&u.classList.add("octs-navigator-item-active"),n.appendChild(u)}}catch(t){i=!0,o=t}finally{try{!r&&l.return&&l.return()}finally{if(i)throw o}}return t},removeNavigatorStatus=function(t){var e=t.children[1].children,n=!0,r=!1,i=void 0;try{for(var o,a=[].entries.call(e)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=_slicedToArray(o.value,2),s=(l[0],l[1]);s.classList.remove("octs-navigator-item-active")}}catch(t){r=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}},slidePrev=function(t,e,n){return new Promise(function(r,i){for(var o=t.children[0],a=t.children[1],l=a.children[e],s=o.style.transition,c=getIndex(a,null,function(t){return t.classList.contains("octs-navigator-item-active")}),d=n?1:c-e,u=[].map.call(o.children,function(t){return t}),v=u.length-1,f=u[0],m=0;m<d;m++){var h=u[v-m];o.insertBefore(h,f),f=h}o.style.cssText="transition: none;\n\t\t\t\t\t\t\tmargin-left: -"+d+"00%;",setTimeout(function(){o.style.cssText="transition: "+s+";\n\t\t\t\t\t\t\t\tmargin-left: 0%;";var e=function e(){removeNavigatorStatus(t),l.classList.add("octs-navigator-item-active"),o.removeEventListener("transitionend",e,!1),r()};o.addEventListener("transitionend",e,!1)},0)})},slideNext=function(t,e,n){return new Promise(function(r,i){var o=t.children[0],a=t.children[1],l=a.children[e],s=o.style.transition,c=getIndex(a,null,function(t){return t.classList.contains("octs-navigator-item-active")}),d=n?1:e-c,u=[].map.call(o.children,function(t){return t});o.style.marginLeft="-"+d+"00%";var v=function e(){for(var n=0;n<d;n++)o.appendChild(u[n]);o.style.cssText="transition: none;\n\t\t\t\t\t\t\t\tmargin-left: 0%;",setTimeout(function(){o.style.transition=s,removeNavigatorStatus(t),l.classList.add("octs-navigator-item-active"),o.removeEventListener("transitionend",e,!1),r()},0)};o.addEventListener("transitionend",v,!1)})},getIndex=function(t,e,n){var r=t.children,i=!0,o=!1,a=void 0;try{for(var l,s=[].entries.call(r)[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var c=_slicedToArray(l.value,2),d=c[0],u=c[1];if(e===u)return d;if(n&&n(u))return d}}catch(t){o=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}},addEventListener=function(t,e){var n=t.children[0].children.length,r=t.children[2].children[0],i=t.children[2].children[1],o=t.children[1],a=!1;t.index=0,t.slide=Promise.resolve();var l=function(e){t.slide=t.slide.then(function(){return t.index=t.index-1<0?n-1:t.index-1,t.index===n-1?slidePrev(t,t.index,!0):slidePrev(t,t.index,!1)})},s=function(e){t.slide=t.slide.then(function(){return t.index=(t.index+1)%n,0===t.index?slideNext(t,t.index,!0):slideNext(t,t.index,!1)})};if(r.addEventListener("click",l,!1),i.addEventListener("click",s,!1),o.addEventListener("click",function(e){var n=e.target;"li"==n.tagName.toLowerCase()&&(t.slide=t.slide.then(function(){var e=getIndex(o,n);return e>t.index?(t.index=e,slideNext(t,t.index,!1)):e<t.index?(t.index=e,slidePrev(t,t.index,!1)):void 0}))},!1),t.addEventListener("mouseover",function(t){a=!0},!1),t.addEventListener("mouseout",function(t){a=!1},!1),e.autoRun){var c=function t(){a||(e.reverse?l():s()),setTimeout(t,e.time)};setTimeout(c,e.time)}return t},defaultSetting={autoRun:!1,reverse:!1,time:3e3},octSlider=function(t,e,n){n=Object.assign(defaultSetting,n);var r=parseDom(template.content)[0];r=insertItemDom(r,e),r=insertNavigatorDom(r,e),r=addEventListener(r,n),t.appendChild(r)};exports.default=octSlider;